var Page={enData:[],heData:[],arData:[],firstTime:!0,currentLang:"en",currentEdit:0,currentIframe:"#background_two",months:["January","February","March","April","May","June","July","August","September","October","November","December"],init:function(){console.log("Page.init"),this.bindEvents(),this.loadingAnim()},bindEvents:function(){console.log("Page.bindEvents");var a=this;$("#en_link").on("click",function(){a.switchLang("en"),$(this).addClass("selected").siblings().removeClass("selected")}),$("#he_link").on("click",function(){a.switchLang("he"),$(this).addClass("selected").siblings().removeClass("selected")}),$("#ar_link").on("click",function(){a.switchLang("ar"),$(this).addClass("selected").siblings().removeClass("selected")}),$("#down_arrow img").on("click",function(){a.showText()})},loadingAnim:function(){console.log("Page.loadingAnim");var a=this;$("body").css("background-color","white"),setTimeout(function(){a.loadLangData("en","Jerusalem")},500)},loadLangData:function(a,b){console.log("Page.loadLangData",a,b);var c=this;$.ajax({url:"https://"+a+".wikipedia.org/w/api.php?action=query&format=json&prop=revisions&list=&titles="+b+"&rvlimit=max",dataType:"jsonp",headers:{"Api-User-Agent":"Palimpsest/1.1 (https://palimpsest.void.xxx/; fredcave@hotmail.com)"},success:function(b){var d=b.query.pages[Object.keys(b.query.pages)[0]];console.log(97,d),"en"===a?c.enData=d.revisions:"he"===a?c.heData=d.revisions:"ar"===a&&(c.arData=d.revisions),c.heData.length?c.arData.length||c.loadLangData("ar","القدس"):c.loadLangData("he","ירושלים"),c.firstTime&&(c.initialLoad(),c.firstTime=!1)}})},initialLoad:function(){console.log("Page.initialLoad"),this.getEdit(),setTimeout(function(){$("#loading").animate({opacity:0},1500,function(){$("#loading").hide()}),$("#iframes_wrapper").css("opacity","1")},1e3)},getEdit:function(){console.log("Page.getEdit");var a,b,c,d=30;"en"===this.currentLang?(c=this.enData,b="Jerusalem"):"he"===this.currentLang?(c=this.heData,b="ירושלים"):"ar"===this.currentLang&&(c=this.arData,b="القدس");var a=c[this.currentEdit],e="https://"+this.currentLang+".wikipedia.org/w/index.php?title="+b+"&oldid="+a.revid;console.log(155,a.revid,a.timestamp,e),this.showInfo(a),this.loadIframe(e),this.currentEdit=this.currentEdit+d,this.currentEdit>=c.length&&(this.currentEdit=0)},showInfo:function(a){console.log("Page.showInfo"),console.log(108,a.timestamp);var b=a.timestamp.split("-"),c=b[2].split("T")[0],d=this.months[b[1]-1],e=b[0];setTimeout(function(){$("#top_bar_info .day").text(c),$("#top_bar_info .month").text(d),$("#top_bar_info .year").text(e)},5e3)},loadIframe:function(a){console.log("Page.loadIframe");var b=this;$(this.currentIframe).attr("src",a),console.log(225,"Source added."),console.log(227,this.currentIframe),setTimeout(function(){$("#wrapper").css("opacity","0.5"),console.log(229,"Fade in.."),$(b.currentIframe).css("opacity","1").siblings().css("opacity","0")},1e3),setTimeout(function(){"#background_one"===this.currentIframe?this.currentIframe="#background_two":this.currentIframe="#background_one",b.getEdit()},5e3)},switchLang:function(a){console.log("Page.switchLang",a),"en"===a?$("#text-en").show().siblings().not("#text_footer").hide():"he"===a?$("#text-he").show().siblings().not("#text_footer").hide():"ar"===a&&$("#text-ar").show().siblings().not("#text_footer").hide()},showText:function(){console.log("Page.showText"),$("#down_arrow").fadeOut(),setTimeout(function(){$("html,body").css("overflow-y","auto"),$("#text_wrapper").css({"margin-top":"18.5vh"})},500)}};$(document).on("ready",function(){$("html,body").animate({scrollTop:0},100),Page.init()});